'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getObjectFromSchema = exports.deepDiff = undefined;

var _mongoose = require('mongoose');

var _mongoose2 = _interopRequireDefault(_mongoose);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _deepDiff = require('deep-diff');

var _deepDiff2 = _interopRequireDefault(_deepDiff);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var Schema = _mongoose2.default.Schema;

var deepDiff = exports.deepDiff = function deepDiff(origin, comparand) {
  var differences = _deepDiff2.default.diff(origin, comparand);
  var result = {};
  differences.forEach(function (element) {
    if (element.kind === 'E') {
      _lodash2.default.merge(result, _lodash2.default.pick(comparand, element.path));
    }
  });
  return result;
};

var getObjectFromSchema = exports.getObjectFromSchema = function getObjectFromSchema(schema) {
  var values = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  var options = {
    server: {
      reconnectTries: 0
    }
  };

  var dummyMongoConnection = _mongoose2.default.createConnection();
  var DummyModel = dummyMongoConnection.model('dummyName', new Schema(schema));
  var getDefaultObject = new DummyModel(values).toJSON();
  delete getDefaultObject._id;
  delete getDefaultObject.__v;
  delete getDefaultObject.$setOnInsert;
  return getDefaultObject;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvdXRpbHMuanMiXSwibmFtZXMiOlsiU2NoZW1hIiwiZGVlcERpZmYiLCJvcmlnaW4iLCJjb21wYXJhbmQiLCJkaWZmZXJlbmNlcyIsImRpZmYiLCJyZXN1bHQiLCJmb3JFYWNoIiwiZWxlbWVudCIsImtpbmQiLCJtZXJnZSIsInBpY2siLCJwYXRoIiwiZ2V0T2JqZWN0RnJvbVNjaGVtYSIsInNjaGVtYSIsInZhbHVlcyIsIm9wdGlvbnMiLCJzZXJ2ZXIiLCJyZWNvbm5lY3RUcmllcyIsImR1bW15TW9uZ29Db25uZWN0aW9uIiwiY3JlYXRlQ29ubmVjdGlvbiIsIkR1bW15TW9kZWwiLCJtb2RlbCIsImdldERlZmF1bHRPYmplY3QiLCJ0b0pTT04iLCJfaWQiLCJfX3YiLCIkc2V0T25JbnNlcnQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQSxTQUFTLG1CQUFTQSxNQUF4Qjs7QUFFTyxJQUFNQyw4QkFBVyxTQUFTQSxRQUFULENBQWtCQyxNQUFsQixFQUEwQkMsU0FBMUIsRUFBcUM7QUFDM0QsTUFBSUMsY0FBYyxtQkFBS0MsSUFBTCxDQUFVSCxNQUFWLEVBQWtCQyxTQUFsQixDQUFsQjtBQUNBLE1BQUlHLFNBQVUsRUFBZDtBQUNBRixjQUFZRyxPQUFaLENBQW9CLG1CQUFXO0FBQzdCLFFBQUlDLFFBQVFDLElBQVIsS0FBaUIsR0FBckIsRUFBMEI7QUFDeEIsdUJBQUVDLEtBQUYsQ0FBUUosTUFBUixFQUFnQixpQkFBRUssSUFBRixDQUFPUixTQUFQLEVBQWtCSyxRQUFRSSxJQUExQixDQUFoQjtBQUNEO0FBQ0YsR0FKRDtBQUtBLFNBQU9OLE1BQVA7QUFDRCxDQVRNOztBQVdBLElBQU1PLG9EQUFzQixTQUFTQSxtQkFBVCxDQUE4QkMsTUFBOUIsRUFBbUQ7QUFBQSxNQUFiQyxNQUFhLHVFQUFKLEVBQUk7O0FBQ3BGLE1BQUlDLFVBQVU7QUFDWkMsWUFBUTtBQUNOQyxzQkFBZ0I7QUFEVjtBQURJLEdBQWQ7O0FBTUEsTUFBSUMsdUJBQXVCLG1CQUFTQyxnQkFBVCxFQUEzQjtBQUNBLE1BQUlDLGFBQWFGLHFCQUFxQkcsS0FBckIsQ0FBMkIsV0FBM0IsRUFBd0MsSUFBSXRCLE1BQUosQ0FBV2MsTUFBWCxDQUF4QyxDQUFqQjtBQUNBLE1BQUlTLG1CQUFtQixJQUFJRixVQUFKLENBQWVOLE1BQWYsRUFBdUJTLE1BQXZCLEVBQXZCO0FBQ0EsU0FBT0QsaUJBQWlCRSxHQUF4QjtBQUNBLFNBQU9GLGlCQUFpQkcsR0FBeEI7QUFDQSxTQUFPSCxpQkFBaUJJLFlBQXhCO0FBQ0EsU0FBT0osZ0JBQVA7QUFDRCxDQWRNIiwiZmlsZSI6InV0aWxzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBkZWVwIGZyb20gXCJkZWVwLWRpZmZcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuXG5leHBvcnQgY29uc3QgZGVlcERpZmYgPSBmdW5jdGlvbiBkZWVwRGlmZihvcmlnaW4sIGNvbXBhcmFuZCkge1xuICBsZXQgZGlmZmVyZW5jZXMgPSBkZWVwLmRpZmYob3JpZ2luLCBjb21wYXJhbmQpO1xuICBsZXQgcmVzdWx0ICA9IHt9O1xuICBkaWZmZXJlbmNlcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgIGlmIChlbGVtZW50LmtpbmQgPT09ICdFJykge1xuICAgICAgXy5tZXJnZShyZXN1bHQsIF8ucGljayhjb21wYXJhbmQsIGVsZW1lbnQucGF0aCkpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0T2JqZWN0RnJvbVNjaGVtYSA9IGZ1bmN0aW9uIGdldE9iamVjdEZyb21TY2hlbWEgKHNjaGVtYSwgdmFsdWVzID0ge30pIHtcbiAgbGV0IG9wdGlvbnMgPSB7XG4gICAgc2VydmVyOiB7XG4gICAgICByZWNvbm5lY3RUcmllczogMCxcbiAgICB9XG4gIH07XG5cbiAgbGV0IGR1bW15TW9uZ29Db25uZWN0aW9uID0gbW9uZ29vc2UuY3JlYXRlQ29ubmVjdGlvbigpO1xuICBsZXQgRHVtbXlNb2RlbCA9IGR1bW15TW9uZ29Db25uZWN0aW9uLm1vZGVsKCdkdW1teU5hbWUnLCBuZXcgU2NoZW1hKHNjaGVtYSkpO1xuICBsZXQgZ2V0RGVmYXVsdE9iamVjdCA9IG5ldyBEdW1teU1vZGVsKHZhbHVlcykudG9KU09OKCk7XG4gIGRlbGV0ZSBnZXREZWZhdWx0T2JqZWN0Ll9pZDtcbiAgZGVsZXRlIGdldERlZmF1bHRPYmplY3QuX192O1xuICBkZWxldGUgZ2V0RGVmYXVsdE9iamVjdC4kc2V0T25JbnNlcnQ7XG4gIHJldHVybiBnZXREZWZhdWx0T2JqZWN0O1xufTtcbiJdfQ==